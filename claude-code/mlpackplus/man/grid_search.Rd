% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tuning.R
\name{grid_search}
\alias{grid_search}
\title{Grid Search Hyperparameter Tuning}
\usage{
grid_search(model_factory, x, y, param_grid, k = 5L, metric_fn = mse)
}
\arguments{
\item{model_factory}{A function that takes named hyperparameter values and
returns a \code{model_fn} (a function(x, y) -> model).}

\item{x}{Numeric matrix of predictors.}

\item{y}{Numeric vector of responses.}

\item{param_grid}{Named list of parameter vectors to search over.}

\item{k}{Number of CV folds (default 5).}

\item{metric_fn}{Metric function (default \code{mse}).}
}
\value{
A list with \code{best_params}, \code{best_score}, and
\code{results} data.frame.
}
\description{
Evaluates all combinations of hyperparameters using k-fold cross-validation.
}
\examples{
set.seed(42)
x <- matrix(rnorm(200), ncol = 2)
y <- x[,1]^2 + rnorm(100, sd = 0.1)
factory <- function(max_depth, min_leaf_size) {
  function(x, y) DecisionTreeRegressor(x, y,
    max_depth = max_depth, min_leaf_size = min_leaf_size)
}
result <- grid_search(factory, x, y,
  param_grid = list(max_depth = c(3, 5), min_leaf_size = c(2, 5)), k = 3)
}
